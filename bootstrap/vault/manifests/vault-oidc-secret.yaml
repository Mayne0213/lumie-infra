# VaultStaticSecret for Vault OIDC credentials
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: vault-oidc-static-secret
  namespace: vault
spec:
  vaultAuthRef: vault-auth
  mount: secret
  type: kv-v2
  path: security/authelia
  refreshAfter: 1h
  destination:
    create: true
    name: vault-oidc-secret
    transformation:
      excludeRaw: true
      templates:
        VAULT_CLIENT_SECRET:
          text: '{{ .Secrets.AUTHELIA_VAULT_CLIENT_SECRET }}'
  rolloutRestartTargets:
    - kind: StatefulSet
      name: vault
