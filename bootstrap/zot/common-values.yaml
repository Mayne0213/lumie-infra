# Common chart values for zot

common:
  name: zot

  # Disable deployment (external chart creates it)
  deployment:
    enabled: false

  service:
    enabled: false

  ingress:
    enabled: false

  # Vault Static Secrets (VSO)
  vaultStaticSecrets:
    # htpasswd secret
    - name: zot-htpasswd-vss
      path: bootstrap/zot
      destination:
        name: zot-htpasswd
        transformation:
          templates:
            htpasswd: "{{ .Secrets.ZOT_HTPASSWD }}"

    # OIDC credentials
    - name: zot-oidc-vss
      path: bootstrap/zot
      destination:
        name: zot-oidc-credentials
        transformation:
          templates:
            credentials.json: '{"clientid":"{{ .Secrets.ZOT_OIDC_CLIENT_ID }}","clientsecret":"{{ .Secrets.ZOT_OIDC_CLIENT_SECRET }}"}'

    # Session keys
    - name: zot-session-vss
      path: bootstrap/zot
      destination:
        name: zot-session-keys
        transformation:
          templates:
            session-keys.json: '{"hashKey":"{{ .Secrets.ZOT_SESSION_HASH_KEY }}","encryptKey":"{{ .Secrets.ZOT_SESSION_BLOCK_KEY }}"}'

    # MinIO S3 credentials
    - name: zot-minio-vss
      path: bootstrap/minio
      destination:
        name: minio-s3-credentials
        transformation:
          templates:
            MINIO_ACCESS_KEY_ID: "{{ .Secrets.MINIO_ROOT_USER }}"
            MINIO_SECRET_ACCESS_KEY: "{{ .Secrets.MINIO_ROOT_PASSWORD }}"
            MINIO_REGION: "us-east-1"
