{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "dependencyDashboard": true,
  "schedule": ["every weekend"],
  "timezone": "Asia/Seoul",
  "packageRules": [
    {
      "matchDatasources": ["docker"],
      "automerge": false,
      "labels": ["docker", "dependencies"]
    },
    {
      "matchPackagePatterns": ["postgres", "postgresql", "cnpg"],
      "groupName": "PostgreSQL"
    },
    {
      "matchPackagePatterns": ["grafana", "loki", "tempo"],
      "groupName": "Grafana Stack"
    },
    {
      "matchPackagePatterns": ["prometheus", "alertmanager", "thanos"],
      "groupName": "Prometheus Stack"
    }
  ],
  "customDatasources": {
    "zot-upstream": {
      "defaultRegistryUrlTemplate": "https://registry-1.docker.io"
    }
  },
  "customManagers": [
    {
      "customType": "regex",
      "fileMatch": ["^renovate\\.json$"],
      "matchStrings": [
        "\"(?<depName>[^\"]+)\":\\s*\"(?<currentValue>[^\"]+)\"\\s*//\\s*docker"
      ],
      "datasourceTemplate": "docker",
      "registryUrlTemplate": "https://registry-1.docker.io"
    },
    {
      "customType": "regex",
      "fileMatch": ["^renovate\\.json$"],
      "matchStrings": [
        "\"(?<depName>[^\"]+)\":\\s*\"(?<currentValue>[^\"]+)\"\\s*//\\s*ghcr"
      ],
      "datasourceTemplate": "docker",
      "registryUrlTemplate": "https://ghcr.io"
    },
    {
      "customType": "regex",
      "fileMatch": ["^renovate\\.json$"],
      "matchStrings": [
        "\"(?<depName>[^\"]+)\":\\s*\"(?<currentValue>[^\"]+)\"\\s*//\\s*quay"
      ],
      "datasourceTemplate": "docker",
      "registryUrlTemplate": "https://quay.io"
    },
    {
      "customType": "regex",
      "fileMatch": ["^renovate\\.json$"],
      "matchStrings": [
        "\"(?<depName>[^\"]+)\":\\s*\"(?<currentValue>[^\"]+)\"\\s*//\\s*k8s"
      ],
      "datasourceTemplate": "docker",
      "registryUrlTemplate": "https://registry.k8s.io"
    }
  ],
  "_dependencies": {
    "_comment": "Images tracked by Renovate - DO NOT remove this section",
    "library/postgres": "17.7",               // docker
    "bitnami/redis": "8.4.0",                 // docker
    "grafana/grafana": "11.5.2",              // docker
    "grafana/loki": "3.4.2",                  // docker
    "grafana/tempo": "2.7.1",                 // docker
    "kong/kong-gateway": "3.9.0",             // docker
    "kong/kubernetes-ingress-controller": "3.4.0", // docker
    "authelia/authelia": "4.39.3",            // docker
    "aquasecurity/trivy-operator": "0.28.0",  // docker
    "kiwigrid/k8s-sidecar": "1.28.0",         // docker
    "minio/minio": "RELEASE.2025-01-20T14-49-07Z", // docker
    "cloudnative-pg/postgresql": "17.4",      // ghcr
    "kyverno/kyverno": "v1.14.0",             // ghcr
    "prometheus/prometheus": "v3.2.1",        // quay
    "prometheus/alertmanager": "v0.28.0",     // quay
    "thanos/thanos": "v0.37.2",               // quay
    "prometheus-operator/prometheus-operator": "v0.79.2", // quay
    "kube-state-metrics/kube-state-metrics": "v2.15.0",   // k8s
    "autoscaling/vpa-recommender": "1.3.0"    // k8s
  }
}
