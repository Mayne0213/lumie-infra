# Common chart values for keycloak

common:
  name: keycloak

  # Disable deployment (external chart creates it)
  deployment:
    enabled: false

  service:
    enabled: false

  # Ingress disabled - access via Teleport only
  ingress:
    enabled: false

  # Vault Static Secrets (VSO)
  vaultStaticSecrets:
    # DB credential secret (password for shared infra-db)
    - name: keycloak-db-bootstrap-static
      path: storage/postgresql
      destination:
        name: keycloak-db-bootstrap
        transformation:
          templates:
            username: keycloak
            password: "{{ .Secrets.POSTGRES_PASSWORD }}"
      rolloutRestartTargets:
        - kind: StatefulSet
          name: keycloak

    # Keycloak admin password
    - name: keycloak-secrets-static
      path: security/keycloak
      destination:
        name: keycloak-secrets
        transformation:
          templates:
            KEYCLOAK_ADMIN_PASSWORD: "{{ .Secrets.KEYCLOAK_ADMIN_PASSWORD }}"
      rolloutRestartTargets:
        - kind: StatefulSet
          name: keycloak

  # CNPG Database disabled - using shared infra-db cluster
  database:
    enabled: false
