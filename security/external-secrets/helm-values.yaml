# External Secrets Operator Helm Values
# Chart: https://github.com/external-secrets/external-secrets

# Replica count
replicaCount: 1

# 리소스 제한 (20% increase from original)
resources:
  requests:
    cpu: 5m
    memory: 154Mi
  limits:
    memory: 154Mi

# 동시 실행 제한
concurrent: 3

# 로그 레벨
logLevel: info

# CRD 자동 설치 비활성화 (annotation 크기 제한 문제 회피)
# CRD는 이미 설치되어 있으며, 업그레이드 시 수동으로 적용 필요
installCRDs: false

# Webhook 설정
webhook:
  replicaCount: 1
  resources:
    requests:
      cpu: 2m
      memory: 154Mi
    limits:
      memory: 154Mi
  # Affinity - Soft Anti-Affinity to spread pods across nodes
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: external-secrets-webhook
            topologyKey: kubernetes.io/hostname

# CertController 설정
certController:
  replicaCount: 1
  resources:
    requests:
      cpu: 2m
      memory: 307Mi
    limits:
      memory: 307Mi
  # Affinity - Soft Anti-Affinity to spread pods across nodes
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: external-secrets-cert-controller
            topologyKey: kubernetes.io/hostname

# Affinity - Soft Anti-Affinity to spread pods across nodes
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchLabels:
              app.kubernetes.io/name: external-secrets
          topologyKey: kubernetes.io/hostname
