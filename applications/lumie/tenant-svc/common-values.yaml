common:
  name: tenant-svc
  namespace: lumie-platform

  deployment:
    enabled: true
    replicas: 2
    image:
      repository: zot0213.kro.kr/applications/tenant-svc
      tag: "0.1.0"
      pullPolicy: IfNotPresent
    ports:
      - name: http
        containerPort: 8080
        protocol: TCP
      - name: grpc
        containerPort: 9090
        protocol: TCP
    resources:
      requests:
        cpu: 100m
        memory: 512Mi
      limits:
        memory: 512Mi
    env:
      - name: SPRING_PROFILES_ACTIVE
        value: "prod"
      - name: DB_HOST
        value: "lumie-db-rw.lumie-db.svc"
      - name: DB_PORT
        value: "5432"
      - name: DB_NAME
        value: "lumie"
      - name: DB_USERNAME
        valueFrom:
          secretKeyRef:
            name: lumie-db-app
            key: username
      - name: DB_PASSWORD
        valueFrom:
          secretKeyRef:
            name: lumie-db-app
            key: password
      - name: RABBITMQ_HOST
        value: "rabbitmq.lumie-event.svc"
      - name: RABBITMQ_PORT
        value: "5672"
      - name: RABBITMQ_USERNAME
        value: "lumie"
      - name: RABBITMQ_PASSWORD
        valueFrom:
          secretKeyRef:
            name: tenant-svc-rabbitmq-secrets
            key: RABBITMQ_PASSWORD
    livenessProbe:
      httpGet:
        path: /actuator/health/liveness
        port: http
      initialDelaySeconds: 60
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      httpGet:
        path: /actuator/health/readiness
        port: http
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    startupProbe:
      httpGet:
        path: /actuator/health/startup
        port: http
      initialDelaySeconds: 10
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 30

  service:
    enabled: true
    type: ClusterIP
    ports:
      - name: http
        port: 8080
        targetPort: http
        protocol: TCP

  ingress:
    enabled: false

  serviceMonitor:
    enabled: true
    path: /actuator/prometheus
    port: http
    interval: 30s

  database:
    enabled: false

  vaultSecret:
    enabled: true
    name: tenant-svc-rabbitmq-secrets
    path: platform/rabbitmq
    data:
      - secretKey: RABBITMQ_PASSWORD
        remoteRef:
          key: platform/rabbitmq
          property: RABBITMQ_PASSWORD
