# Common chart values for umami
# Replaces manifests/ folder with Helm-based configuration

common:
  name: umami

  # Disable deployment (external chart creates it)
  deployment:
    enabled: false

  # Disable service/ingress (external chart creates them)
  service:
    enabled: false

  ingress:
    enabled: false

  # Vault Static Secrets (VSO)
  vaultStaticSecrets:
    - name: umami-vss
      path: applications/umami
      destination:
        name: umami-hash-salt
        transformation:
          templates:
            hash-salt: "{{ .Secrets.UMAMI_HASH_SALT }}"

    # DB secret (replaces CNPG auto-generated umami-db-app)
    - name: umami-db-app-vss
      path: storage/postgresql
      destination:
        name: umami-db-app
        transformation:
          templates:
            host: infra-db-rw.infra-db.svc.cluster.local
            port: "5432"
            username: umami
            password: "{{ .Secrets.POSTGRES_PASSWORD }}"
            dbname: umami
            uri: "postgresql://umami:{{ .Secrets.POSTGRES_PASSWORD }}@infra-db-rw.infra-db.svc.cluster.local:5432/umami"

  # CNPG Database disabled - using shared infra-db cluster
  database:
    enabled: false
