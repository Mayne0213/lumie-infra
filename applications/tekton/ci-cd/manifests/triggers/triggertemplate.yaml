apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: nextjs-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: nextjs-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: nextjs-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: ./nextjs
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: web-apps/values/$(tt.params.repo-name).yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: docusaurus-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: nextjs-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: nextjs-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: .
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/docusaurus/helm-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: nextjs-dev-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-dev-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: nextjs-build-deploy
          app: $(tt.params.repo-name)-dev
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: nextjs-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)-dev
          - name: context-dir
            value: ./nextjs
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: web-apps/values/$(tt.params.repo-name)-dev.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: fastapi-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: ./fastapi
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: web-apps/values/$(tt.params.repo-name).yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: mas-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: ./langgraph
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/mas/helm-values.yaml
          - name: yq-path
            value: ".controllers.main.containers.main.image.tag"
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: fastapi-dev-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-dev-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: $(tt.params.repo-name)-dev
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)-dev
          - name: context-dir
            value: ./fastapi
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: web-apps/values/$(tt.params.repo-name)-dev.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: poolc-frontend-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: poolc-frontend-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: react-build-deploy
          app: poolc-frontend
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: react-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: poolc-frontend
          - name: context-dir
            value: .
          - name: image-prefix
            value: web-apps/
          - name: build-args
            value:
              - "--build-arg=VITE_API_BASE_URL=https://dev.poolc0213.kro.kr/api"
          - name: update-values
            value: "true"
          - name: values-file-path
            value: web-apps/values/poolc-frontend-dev.yaml,web-apps/values/poolc-frontend.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: poolc-backend-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: poolc-backend-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: springboot-build-deploy
          app: poolc-backend
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: poolc-backend
          - name: context-dir
            value: .
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: web-apps/values/poolc-backend-dev.yaml,web-apps/values/poolc-backend.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
