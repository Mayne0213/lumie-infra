apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: nextjs-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
    - name: build-args
      description: Docker build arguments (comma-separated)
      default: ""
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: nextjs-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: nextjs-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: ./nextjs
          - name: image-prefix
            value: web-apps/
          - name: build-args
            value: $(tt.params.build-args)
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/$(tt.params.repo-name)/helm-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: docusaurus-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: nextjs-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: nextjs-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: .
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/docusaurus/helm-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: fastapi-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: ./fastapi
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/$(tt.params.repo-name)/helm-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: mas-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: $(tt.params.repo-name)-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: $(tt.params.repo-name)
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: $(tt.params.repo-name)
          - name: context-dir
            value: ./langgraph
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/mas/helm-values.yaml
          - name: yq-path
            value: ".controllers.main.containers.main.image.tag"
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: poolc-frontend-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: poolc-frontend-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: react-build-deploy
          app: poolc-frontend
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: react-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: poolc-frontend
          - name: context-dir
            value: .
          - name: image-prefix
            value: web-apps/
          - name: build-args
            value:
              - "--build-arg=VITE_API_BASE_URL=https://dev.poolc0213.kro.kr/api"
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/poolc-dev/helm-values.yaml
          - name: yq-path
            value: ".common.components[1].image.tag"
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: poolc-backend-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: poolc-backend-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: springboot-build-deploy
          app: poolc-backend
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: poolc-backend
          - name: context-dir
            value: .
          - name: image-prefix
            value: web-apps/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/poolc-dev/helm-values.yaml
          - name: yq-path
            value: ".common.components[0].image.tag"
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
# Lumie TriggerTemplates (GitHub)
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-tenant-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: tenant-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: tenant-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: tenant-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/platform/tenant-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/tenant-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-auth-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: auth-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: auth-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: auth-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/platform/auth-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/auth-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-billing-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: billing-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: billing-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: billing-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/platform/billing-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/billing-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-academy-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: academy-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: academy-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: academy-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/core/academy-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/academy-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-frontend-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: lumie-frontend-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: nextjs-build-deploy
          app: lumie-frontend
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: nextjs-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: lumie-frontend
          - name: context-dir
            value: .
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/lumie-frontend/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
# Lumie AI TriggerTemplates
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-grading-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: grading-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: grading-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: grading-svc
          - name: context-dir
            value: ./services/grading
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/grading-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-exam-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: exam-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: exam-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: exam-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/core/exam-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/exam-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-content-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: content-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: content-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: content-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/core/content-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/content-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-file-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: file-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: file-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: file-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/support/file-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/file-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-spreadsheet-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: spreadsheet-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: lumie-springboot-build-deploy
          app: spreadsheet-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 45m
        pipelineRef:
          name: lumie-springboot-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: service-name
            value: spreadsheet-svc
          - name: context-dir
            value: .
          - name: dockerfile-path
            value: services/core/spreadsheet-svc/Dockerfile
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "true"
          - name: values-file-path
            value: applications/lumie/spreadsheet-svc/common-values.yaml
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-report-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: report-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: report-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: report-svc
          - name: context-dir
            value: ./services/report
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "false"
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: lumie-audio-svc-build-template
  namespace: tekton-pipelines
spec:
  params:
    - name: git-url
      description: Git repository URL
    - name: git-revision
      description: Git commit SHA
    - name: git-branch
      description: Git branch name
    - name: repo-name
      description: Repository name
    - name: repo-full-name
      description: Full repository name (org/repo)
  resourcetemplates:
    - apiVersion: tekton.dev/v1
      kind: PipelineRun
      metadata:
        generateName: audio-svc-build-
        namespace: tekton-pipelines
        labels:
          tekton.dev/pipeline: fastapi-build-deploy
          app: audio-svc
          branch: $(tt.params.git-branch)
      spec:
        timeouts:
          pipeline: 30m
        pipelineRef:
          name: fastapi-build-deploy
        onSuccessfulCompletion: delete
        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-branch)
          - name: app-name
            value: audio-svc
          - name: context-dir
            value: ./services/audio
          - name: image-prefix
            value: applications/
          - name: update-values
            value: "false"
        workspaces:
          - name: shared-workspace
            emptyDir: {}
          - name: docker-credentials
            secret:
              secretName: zot-registry-credentials
