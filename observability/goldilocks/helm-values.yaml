# Goldilocks Helm Values
# Reference: https://github.com/FairwindsOps/charts/tree/master/stable/goldilocks

# Dashboard configuration
dashboard:
  enabled: true
  replicaCount: 1

  resources:
    requests:
      cpu: 15m
      memory: 100Mi
    limits:
      memory: 100Mi

  service:
    type: ClusterIP
    port: 80

  ingress:
    enabled: true
    ingressClassName: traefik
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      traefik.ingress.kubernetes.io/router.middlewares: authelia-authelia-auth@kubernetescrd
    hosts:
      - host: goldilocks0213.kro.kr
        paths:
          - path: /
            type: Prefix
    tls:
      - secretName: goldilocks-dashboard-tls
        hosts:
          - goldilocks0213.kro.kr
  
  # Affinity - Soft Anti-Affinity to spread pods across nodes
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: goldilocks
            topologyKey: kubernetes.io/hostname

# Controller configuration
controller:
  enabled: true
  replicaCount: 1

  resources:
    requests:
      cpu: 15m
      memory: 100Mi
    limits:
      memory: 100Mi

  # Enable VPA recommendations for all namespaces
  # Set to false to only monitor namespaces with the label: goldilocks.fairwinds.com/enabled=true
  enableCostRecommendations: true

  # Schedule on control-plane node
  nodeSelector:
    node-role.kubernetes.io/control-plane: "true"

  tolerations:
    - key: node-role.kubernetes.io/control-plane
      operator: Exists
      effect: NoSchedule

# VPA configuration (should already be installed)
vpa:
  # Set to false since we're installing VPA separately
  enabled: false
