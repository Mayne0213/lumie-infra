# Alertmanager Helm Values
# Chart: https://github.com/prometheus-community/helm-charts/tree/main/charts/alertmanager

fullnameOverride: alertmanager

replicaCount: 2

# Soft anti-affinity to spread pods across nodes
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchLabels:
              app.kubernetes.io/name: alertmanager
          topologyKey: kubernetes.io/hostname

# Use emptyDir instead of PVC (alert state is temporary)
persistence:
  enabled: false

extraVolumes:
  - name: storage
    emptyDir:
      sizeLimit: 500Mi

extraVolumeMounts:
  - name: storage
    mountPath: /alertmanager

resources:
  requests:
    cpu: 15m
    memory: 100Mi
  limits:
    memory: 100Mi

# Disable default config - use secret instead
config:
  enabled: false

# Mount config from ExternalSecret
extraSecretMounts:
  - name: alertmanager-config
    mountPath: /etc/alertmanager
    secretName: alertmanager-config
    readOnly: true
